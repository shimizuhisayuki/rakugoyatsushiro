<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è½èªä¼š ã”äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ </title>
<style>
  body {
    font-family: "Yu Gothic UI", sans-serif;
    background-color: #fffaf5;
    margin: 0;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .container {
    text-align: center;
    background-color: rgba(255,255,255,0.9);
    padding: 50px;
    border-radius: 20px;
    max-width: 700px;
    width: 90%;
  }

  h1 {
    font-size: 36px;
    margin-bottom: 30px;
  }

  p {
    font-size: 20px;
    margin-bottom: 20px;
  }

  select, input {
    width: 85%;
    font-size: 18px;
    margin: 12px 0;
    padding: 10px;
    border: none;
    border-bottom: 2px solid #aaa;
    background: transparent;
    text-align: center;
  }

  button {
    background-color: #ff8c42;
    color: white;
    border-radius: 10px;
    border: none;
    padding: 14px 35px;
    font-size: 20px;
    cursor: pointer;
    margin-top: 15px;
  }

  button:hover {
    background-color: #ff7b00;
  }

  .hidden {
    display: none;
  }

  .back-btn {
    background-color: #ccc;
    color: #333;
    margin-top: 10px;
  }

  .back-btn:hover {
    background-color: #aaa;
  }

  #domainList span {
    cursor: pointer;
  }
  #domainList span:hover {
    text-decoration: underline;
    color: #ff8c42;
  }
</style>
</head>
<body>
<div class="container">
  <h1>è½èªä¼š ã”äºˆç´„</h1>

  <!-- ã‚¹ãƒ†ãƒƒãƒ—1 -->
  <div id="step1">
    <p>â‘  å‚åŠ ã—ãŸã„è½èªä¼šã‚’é¸ã‚“ã§ãã ã•ã„</p>
    <select id="event">
      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
      <option>è½èªä¼šï¼‘</option>
      <option>è½èªä¼šï¼’</option>
      <option>è½èªä¼šï¼“</option>
      <option>è½èªä¼šï¼”</option>
    </select><br>
    <button type="button" onclick="nextStep(2)">æ¬¡ã¸</button>
  </div>

  <!-- ã‚¹ãƒ†ãƒƒãƒ—2 -->
  <div id="step2" class="hidden">
    <p>â‘¡ ã”äºˆç´„è€…æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
    <input type="text" id="name" placeholder="ãŠåå‰"><br>
    <input type="tel" id="phone" placeholder="é›»è©±ç•ªå·"><br>
    <select id="pref">
      <option value="">éƒ½é“åºœçœŒã‚’é¸æŠ</option>
      <option>ç†Šæœ¬çœŒ</option>
    </select><br>
    <select id="city">
      <option value="">å¸‚åŒºç”ºæ‘ã‚’é¸æŠ</option>
      <option>ç†Šæœ¬å¸‚ä¸­å¤®åŒº</option>
      <option>ç†Šæœ¬å¸‚æ±åŒº</option>
      <option>ç†Šæœ¬å¸‚è¥¿åŒº</option>
      <option>ç†Šæœ¬å¸‚å—åŒº</option>
      <option>ç†Šæœ¬å¸‚åŒ—åŒº</option>
      <option>å…«ä»£å¸‚</option>
      <option>äººå‰å¸‚</option>
      <option>è’å°¾å¸‚</option>
      <option>æ°´ä¿£å¸‚</option>
      <option>ç‰åå¸‚</option>
      <option>å±±é¹¿å¸‚</option>
      <option>èŠæ± å¸‚</option>
      <option>å®‡åœŸå¸‚</option>
      <option>ä¸Šå¤©è‰å¸‚</option>
      <option>å®‡åŸå¸‚</option>
      <option>é˜¿è˜‡å¸‚</option>
      <option>å¤©è‰å¸‚</option>
      <option>åˆå¿—å¸‚</option>
      <option>ãã®ä»–ï¼ˆç”ºãƒ»æ‘ï¼‰</option>
    </select><br>
    <input type="text" id="address" placeholder="å¸‚ä»¥é™ã®ä½æ‰€ãƒ»ç•ªåœ°ãªã©ï¼ˆä»»æ„ï¼‰"><br>
    <input type="email" id="email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆä»»æ„ï¼‰"><br>
    <div id="domainList" class="hidden" style="text-align:left; margin:5px 0; font-size:16px; color:#555;">
      <span class="domain-item" data-domain="@gmail.com">@gmail.com</span><br>
      <span class="domain-item" data-domain="@yahoo.co.jp">@yahoo.co.jp</span><br>
      <span class="domain-item" data-domain="@icloud.com">@icloud.com</span>
    </div>
    <button type="button" onclick="backStep(1)" class="back-btn">æˆ»ã‚‹</button>
    <button type="button" onclick="validateAndNext()">ç¢ºèªç”»é¢ã¸</button>
  </div>

  <!-- ç¢ºèªç”»é¢ -->
  <div id="confirm" class="hidden">
    <p>ğŸ“‹ ä»¥ä¸‹ã®å†…å®¹ã§é€ä¿¡ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ</p>
    <div id="confirmText" style="text-align:left; font-size:18px; margin:15px 0;"></div>
    <button type="button" id="submitBtn">é€ä¿¡ã™ã‚‹</button><br>
    <button type="button" onclick="editStep(2)" class="back-btn">ä¿®æ­£ã™ã‚‹</button>
  </div>

  <!-- å®Œäº†ç”»é¢ -->
  <div id="thanks" class="hidden">
    <h2>âœ… ã”äºˆç´„ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h2>
    <p>æ‹…å½“è€…ã‚ˆã‚ŠæŠ˜ã‚Šè¿”ã—ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚</p>
    <button type="button" onclick="resetForm()">ã¯ã˜ã‚ã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
  </div>
</div>

<script>
  function nextStep(step) {
    document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
    document.getElementById('step' + step)?.classList.remove('hidden');
  }

  function backStep(step) {
    document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
    document.getElementById('step' + step)?.classList.remove('hidden');
  }

  function editStep(step) {
    backStep(step);
  }

  function resetForm() {
    document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
    document.getElementById('step1').classList.remove('hidden');
  }

  // ãƒ¡ãƒ¼ãƒ«å…¥åŠ›è£œå®Œ
  const emailInput = document.getElementById("email");
  const domainList = document.getElementById("domainList");

  emailInput.addEventListener("input", function() {
    const value = emailInput.value;
    if (value.includes("@") && value.split("@")[1] === "") {
      domainList.classList.remove("hidden");
    } else {
      domainList.classList.add("hidden");
    }
  });

  domainList.querySelectorAll(".domain-item").forEach(item => {
    item.addEventListener("click", () => {
      const localPart = emailInput.value.split("@")[0];
      emailInput.value = localPart + item.dataset.domain;
      domainList.classList.add("hidden");
    });
  });

  // å…¥åŠ›ãƒã‚§ãƒƒã‚¯ + ç¢ºèªç”»é¢ã¸é€²ã‚€
  function validateAndNext() {
    const required = ['name','phone','pref','city']; // emailã¨addressã¯ä»»æ„

    for (let id of required) {
      const el = document.getElementById(id);
      if (!el.value.trim()) {
        alert(`${el.placeholder}ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚`);
        el.focus();
        return;
      }
    }

    const email = document.getElementById('email').value.trim();
    if (email !== "" && !email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
      alert("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“");
      return;
    }

    document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
    document.getElementById('confirm').classList.remove('hidden');

    const e = document.getElementById('event').value;
    const n = document.getElementById('name').value;
    const p = document.getElementById('phone').value;
    const pr = document.getElementById('pref').value;
    const c = document.getElementById('city').value;
    const a = document.getElementById('address').value;
    const m = document.getElementById('email').value;

    document.getElementById('confirmText').innerHTML =
      `<b>ã‚¤ãƒ™ãƒ³ãƒˆ:</b> ${e}<br>
       <b>ãŠåå‰:</b> ${n}<br>
       <b>é›»è©±ç•ªå·:</b> ${p}<br>
       <b>ä½æ‰€:</b> ${pr} ${c} ${a}<br>
       <b>ãƒ¡ãƒ¼ãƒ«:</b> ${m}`;
  }

  // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
  async function sendForm() {
    const formData = new FormData();
    formData.append("ã‚¤ãƒ™ãƒ³ãƒˆ", document.getElementById('event').value);
    formData.append("ãŠåå‰", document.getElementById('name').value);
    formData.append("é›»è©±ç•ªå·", document.getElementById('phone').value);
    formData.append("éƒ½é“åºœçœŒ", document.getElementById('pref').value);
    formData.append("å¸‚åŒºç”ºæ‘", document.getElementById('city').value);
    formData.append("ä½æ‰€", document.getElementById('address').value);
    formData.append("ãƒ¡ãƒ¼ãƒ«", document.getElementById('email').value);

    try {
      const response = await fetch("https://formspree.io/f/xdkynjdk", {
        method: "POST",
        body: formData,
        headers: { "Accept": "application/json" }
      });

      if (response.ok) {
        showThanks();
      } else {
        alert("é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
      }
    } catch (err) {
      alert("é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
    }
  }

  document.getElementById('submitBtn').addEventListener('click', sendForm);

  function showThanks() {
    document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
    document.getElementById('thanks').classList.remove('hidden');
  }
</script>
</body>
</html>

